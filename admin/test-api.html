<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¤©é“æ–‡åŒ–åå°æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }

    .header p {
      opacity: 0.9;
      font-size: 14px;
    }

    .config-section {
      padding: 20px 30px;
      border-bottom: 1px solid #eee;
      background: #fafafa;
    }

    .config-row {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-bottom: 15px;
    }

    .config-row label {
      min-width: 100px;
      font-weight: 500;
    }

    .config-row input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5568d3;
    }

    .btn-success {
      background: #48bb78;
      color: white;
    }

    .btn-success:hover {
      background: #38a169;
    }

    .btn-danger {
      background: #f56565;
      color: white;
    }

    .btn-danger:hover {
      background: #e53e3e;
    }

    .btn-secondary {
      background: #718096;
      color: white;
    }

    .btn-secondary:hover {
      background: #4a5568;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      padding: 30px;
      border-bottom: 1px solid #eee;
    }

    .stat-card {
      padding: 20px;
      border-radius: 8px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .stat-card.success {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
    }

    .stat-card.error {
      background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
    }

    .stat-card.pending {
      background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
    }

    .stat-label {
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 8px;
    }

    .stat-value {
      font-size: 32px;
      font-weight: bold;
    }

    .progress-bar {
      margin: 20px 30px;
      height: 8px;
      background: #e2e8f0;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      transition: width 0.3s;
      width: 0%;
    }

    .results {
      padding: 30px;
    }

    .module {
      margin-bottom: 30px;
    }

    .module-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px 20px;
      background: #f7fafc;
      border-radius: 8px;
      cursor: pointer;
      user-select: none;
      margin-bottom: 10px;
    }

    .module-header:hover {
      background: #edf2f7;
    }

    .module-title {
      font-size: 18px;
      font-weight: 600;
      color: #2d3748;
    }

    .module-stats {
      display: flex;
      gap: 15px;
      font-size: 14px;
    }

    .module-stat {
      padding: 4px 12px;
      border-radius: 12px;
      font-weight: 500;
    }

    .module-stat.total {
      background: #e6fffa;
      color: #234e52;
    }

    .module-stat.success {
      background: #c6f6d5;
      color: #22543d;
    }

    .module-stat.error {
      background: #fed7d7;
      color: #742a2a;
    }

    .api-list {
      display: none;
    }

    .api-list.show {
      display: block;
    }

    .api-item {
      padding: 15px 20px;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      margin-bottom: 10px;
      transition: all 0.3s;
    }

    .api-item.success {
      border-left: 4px solid #48bb78;
      background: #f0fff4;
    }

    .api-item.error {
      border-left: 4px solid #f56565;
      background: #fff5f5;
    }

    .api-item.pending {
      border-left: 4px solid #ed8936;
      background: #fffaf0;
    }

    .api-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .api-name {
      font-weight: 600;
      font-size: 15px;
      color: #2d3748;
    }

    .api-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      font-weight: 500;
    }

    .status-icon {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .status-icon.success {
      background: #48bb78;
    }

    .status-icon.error {
      background: #f56565;
    }

    .status-icon.pending {
      background: #ed8936;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .api-info {
      font-size: 13px;
      color: #718096;
      margin-bottom: 8px;
    }

    .api-time {
      font-size: 12px;
      color: #a0aec0;
    }

    .api-details {
      margin-top: 10px;
      padding: 10px;
      background: white;
      border-radius: 4px;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
    }

    .api-details pre {
      margin: 0;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .log-console {
      margin-top: 20px;
      padding: 15px;
      background: #1a202c;
      color: #e2e8f0;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
    }

    .log-entry {
      margin-bottom: 5px;
      padding: 5px;
      border-left: 3px solid transparent;
    }

    .log-entry.info {
      border-left-color: #4299e1;
    }

    .log-entry.success {
      border-left-color: #48bb78;
    }

    .log-entry.error {
      border-left-color: #f56565;
    }

    .log-time {
      color: #a0aec0;
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ§ª å¤©é“æ–‡åŒ–åå°æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•</h1>
      <p>å…¨é¢æµ‹è¯•æ‰€æœ‰åå°ç®¡ç†æ¥å£ | å…ˆå†™åè¯»éªŒè¯ | è‡ªåŠ¨åŒ–æµ‹è¯•æŠ¥å‘Š</p>
    </div>

    <div class="config-section">
      <div class="config-row">
        <label>ç¯å¢ƒID:</label>
        <input type="text" id="envId" value="cloud1-0gnn3mn17b581124" placeholder="CloudBase ç¯å¢ƒ ID">
      </div>
      <div class="config-row">
        <label>ç®¡ç†å‘˜è´¦å·:</label>
        <input type="text" id="username" value="admin" placeholder="ç®¡ç†å‘˜ç”¨æˆ·å">
      </div>
      <div class="config-row">
        <label>ç®¡ç†å‘˜å¯†ç :</label>
        <input type="password" id="password" value="admin123" placeholder="ç®¡ç†å‘˜å¯†ç ">
      </div>
      <div class="btn-group">
        <button class="btn btn-primary" onclick="startTest()">ğŸš€ å¼€å§‹å…¨é‡æµ‹è¯•</button>
        <button class="btn btn-success" onclick="testReadOnly()">ğŸ“– ä»…æµ‹è¯•è¯»æ¥å£</button>
        <button class="btn btn-danger" onclick="clearResults()">ğŸ—‘ï¸ æ¸…ç©ºç»“æœ</button>
        <button class="btn btn-secondary" onclick="exportReport()">ğŸ“Š å¯¼å‡ºæŠ¥å‘Š</button>
      </div>
    </div>

    <div class="stats">
      <div class="stat-card">
        <div class="stat-label">æ€»æ¥å£æ•°</div>
        <div class="stat-value" id="totalCount">0</div>
      </div>
      <div class="stat-card success">
        <div class="stat-label">æµ‹è¯•é€šè¿‡</div>
        <div class="stat-value" id="successCount">0</div>
      </div>
      <div class="stat-card error">
        <div class="stat-label">æµ‹è¯•å¤±è´¥</div>
        <div class="stat-value" id="errorCount">0</div>
      </div>
      <div class="stat-card pending">
        <div class="stat-label">å¾…æµ‹è¯•</div>
        <div class="stat-value" id="pendingCount">0</div>
      </div>
    </div>

    <div class="progress-bar">
      <div class="progress-fill" id="progressBar"></div>
    </div>

    <div class="results" id="results"></div>

    <div class="log-console" id="logConsole"></div>
  </div>

  <script src="https://web-9gikcbug35bad3a8-1257172164.tcloudbaseapp.com/sdk/1.7.0/cloud.js"></script>
  <script>
    // å…¨å±€å˜é‡
    let app = null;
    let jwtToken = null;
    let testResults = {
      total: 0,
      success: 0,
      error: 0,
      pending: 0,
      modules: {}
    };

    // æµ‹è¯•æ•°æ®å­˜å‚¨ï¼ˆç”¨äºå…ˆå†™åè¯»éªŒè¯ï¼‰
    let testData = {
      createdIds: {},
      testUser: null,
      testOrder: null,
      testCourse: null,
      testClassRecord: null
    };

    // åˆå§‹åŒ– CloudBase
    function initCloudBase() {
      const envId = document.getElementById('envId').value;
      app = window.cloudbase.init({
        env: envId
      });
      log('info', `CloudBase åˆå§‹åŒ–æˆåŠŸ: ${envId}`);
    }

    // æ—¥å¿—è¾“å‡º
    function log(type, message) {
      const logConsole = document.getElementById('logConsole');
      const time = new Date().toLocaleTimeString();
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.innerHTML = `<span class="log-time">[${time}]</span>${message}`;
      logConsole.appendChild(entry);
      logConsole.scrollTop = logConsole.scrollHeight;
      console.log(`[${type}] ${message}`);
    }

    // æ›´æ–°ç»Ÿè®¡æ•°æ®
    function updateStats() {
      document.getElementById('totalCount').textContent = testResults.total;
      document.getElementById('successCount').textContent = testResults.success;
      document.getElementById('errorCount').textContent = testResults.error;
      document.getElementById('pendingCount').textContent = testResults.pending;

      const progress = testResults.total > 0 ?
        ((testResults.success + testResults.error) / testResults.total * 100) : 0;
      document.getElementById('progressBar').style.width = progress + '%';
    }

    // è°ƒç”¨äº‘å‡½æ•°
    async function callCloudFunction(functionName, action, params = {}) {
      try {
        const requestData = {
          action: action,
          jwtToken: jwtToken,
          ...params
        };

        log('info', `è°ƒç”¨æ¥å£: ${functionName}.${action}`);

        const result = await app.callFunction({
          name: functionName,
          data: requestData
        });

        if (result.result.success) {
          log('success', `âœ“ ${functionName}.${action} æˆåŠŸ`);
          return { success: true, data: result.result.data };
        } else {
          log('error', `âœ— ${functionName}.${action} å¤±è´¥: ${result.result.message}`);
          return { success: false, error: result.result.message };
        }
      } catch (error) {
        log('error', `âœ— ${functionName}.${action} å¼‚å¸¸: ${error.message}`);
        return { success: false, error: error.message };
      }
    }

    // ç®¡ç†å‘˜ç™»å½•
    async function adminLogin() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      log('info', 'å¼€å§‹ç®¡ç†å‘˜ç™»å½•...');

      const result = await callCloudFunction('system', 'login', {
        username: username,
        password: password
      });

      if (result.success && result.data.token) {
        jwtToken = result.data.token;
        log('success', 'âœ“ ç®¡ç†å‘˜ç™»å½•æˆåŠŸ');
        return true;
      } else {
        log('error', 'âœ— ç®¡ç†å‘˜ç™»å½•å¤±è´¥');
        return false;
      }
    }

    // æ¸²æŸ“æµ‹è¯•ç»“æœ
    function renderResults() {
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      for (const [moduleName, moduleData] of Object.entries(testResults.modules)) {
        const moduleDiv = document.createElement('div');
        moduleDiv.className = 'module';

        const successCount = moduleData.apis.filter(api => api.status === 'success').length;
        const errorCount = moduleData.apis.filter(api => api.status === 'error').length;

        moduleDiv.innerHTML = `
          <div class="module-header" onclick="toggleModule('${moduleName}')">
            <div class="module-title">${moduleData.title}</div>
            <div class="module-stats">
              <span class="module-stat total">æ€»æ•°: ${moduleData.apis.length}</span>
              <span class="module-stat success">æˆåŠŸ: ${successCount}</span>
              <span class="module-stat error">å¤±è´¥: ${errorCount}</span>
            </div>
          </div>
          <div class="api-list" id="module-${moduleName}">
            ${moduleData.apis.map(api => renderApiItem(api)).join('')}
          </div>
        `;

        resultsDiv.appendChild(moduleDiv);
      }
    }

    // æ¸²æŸ“å•ä¸ªæ¥å£é¡¹
    function renderApiItem(api) {
      const statusClass = api.status || 'pending';
      const statusText = {
        'success': 'âœ“ é€šè¿‡',
        'error': 'âœ— å¤±è´¥',
        'pending': 'â³ å¾…æµ‹è¯•'
      }[statusClass];

      return `
        <div class="api-item ${statusClass}">
          <div class="api-header">
            <div class="api-name">${api.name}</div>
            <div class="api-status">
              <span class="status-icon ${statusClass}"></span>
              ${statusText}
            </div>
          </div>
          <div class="api-info">
            <strong>æ¥å£:</strong> ${api.function}.${api.action} |
            <strong>ç±»å‹:</strong> ${api.type}
          </div>
          ${api.time ? `<div class="api-time">è€—æ—¶: ${api.time}ms</div>` : ''}
          ${api.details ? `
            <div class="api-details">
              <pre>${JSON.stringify(api.details, null, 2)}</pre>
            </div>
          ` : ''}
        </div>
      `;
    }

    // åˆ‡æ¢æ¨¡å—æ˜¾ç¤º
    function toggleModule(moduleName) {
      const moduleList = document.getElementById(`module-${moduleName}`);
      moduleList.classList.toggle('show');
    }

    // æ›´æ–°æ¥å£çŠ¶æ€
    function updateApiStatus(moduleName, apiName, status, details = null, time = null) {
      const module = testResults.modules[moduleName];
      if (!module) return;

      const api = module.apis.find(a => a.name === apiName);
      if (!api) return;

      if (api.status === 'pending') {
        testResults.pending--;
      }

      api.status = status;
      api.details = details;
      api.time = time;

      if (status === 'success') {
        testResults.success++;
      } else if (status === 'error') {
        testResults.error++;
      }

      updateStats();
      renderResults();
    }

    // å®šä¹‰æ‰€æœ‰æµ‹è¯•æ¥å£
    const testAPIs = {
      system: {
        title: 'ç³»ç»Ÿç®¡ç†æ¨¡å— (21ä¸ªæ¥å£)',
        apis: [
          // èº«ä»½è®¤è¯
          { name: 'ç®¡ç†å‘˜ç™»å½•', function: 'system', action: 'login', type: 'è¯»æ“ä½œ', test: testSystemLogin },

          // ç³»ç»Ÿé…ç½®
          { name: 'è·å–ç³»ç»Ÿé…ç½®', function: 'system', action: 'getConfig', type: 'è¯»æ“ä½œ', test: testGetConfig },
          { name: 'æ›´æ–°ç³»ç»Ÿé…ç½®', function: 'system', action: 'updateConfig', type: 'å†™æ“ä½œ', test: testUpdateConfig },
          { name: 'è·å–ç»Ÿè®¡æ•°æ®', function: 'system', action: 'getStatistics', type: 'è¯»æ“ä½œ', test: testGetStatistics },

          // ç®¡ç†å‘˜ç®¡ç†
          { name: 'è·å–ç®¡ç†å‘˜åˆ—è¡¨', function: 'system', action: 'getAdminUserList', type: 'è¯»æ“ä½œ', test: testGetAdminUserList },
          { name: 'åˆ›å»ºç®¡ç†å‘˜', function: 'system', action: 'createAdminUser', type: 'å†™æ“ä½œ', test: testCreateAdminUser },
          { name: 'æ›´æ–°ç®¡ç†å‘˜', function: 'system', action: 'updateAdminUser', type: 'å†™æ“ä½œ', test: testUpdateAdminUser },
          { name: 'åˆ é™¤ç®¡ç†å‘˜', function: 'system', action: 'deleteAdminUser', type: 'å†™æ“ä½œ', test: testDeleteAdminUser },

          // å…¬å‘Šç®¡ç†
          { name: 'è·å–å…¬å‘Šåˆ—è¡¨', function: 'system', action: 'getAnnouncementList', type: 'è¯»æ“ä½œ', test: testGetAnnouncementList },
          { name: 'åˆ›å»ºå…¬å‘Š', function: 'system', action: 'createAnnouncement', type: 'å†™æ“ä½œ', test: testCreateAnnouncement },
          { name: 'æ›´æ–°å…¬å‘Š', function: 'system', action: 'updateAnnouncement', type: 'å†™æ“ä½œ', test: testUpdateAnnouncement },
          { name: 'åˆ é™¤å…¬å‘Š', function: 'system', action: 'deleteAnnouncement', type: 'å†™æ“ä½œ', test: testDeleteAnnouncement },

          // åé¦ˆç®¡ç†
          { name: 'è·å–åé¦ˆåˆ—è¡¨', function: 'system', action: 'getFeedbackList', type: 'è¯»æ“ä½œ', test: testGetFeedbackList },
          { name: 'å›å¤åé¦ˆ', function: 'system', action: 'replyFeedback', type: 'å†™æ“ä½œ', test: testReplyFeedback },

          // é€šçŸ¥ç®¡ç†
          { name: 'è·å–é€šçŸ¥é…ç½®åˆ—è¡¨', function: 'system', action: 'getNotificationConfigList', type: 'è¯»æ“ä½œ', test: testGetNotificationConfigList },
          { name: 'åˆ›å»ºé€šçŸ¥é…ç½®', function: 'system', action: 'createNotificationConfig', type: 'å†™æ“ä½œ', test: testCreateNotificationConfig },
          { name: 'æ›´æ–°é€šçŸ¥é…ç½®', function: 'system', action: 'updateNotificationConfig', type: 'å†™æ“ä½œ', test: testUpdateNotificationConfig },
          { name: 'è·å–é€šçŸ¥æ—¥å¿—', function: 'system', action: 'getNotificationLogs', type: 'è¯»æ“ä½œ', test: testGetNotificationLogs },

          // å¤§ä½¿ç­‰çº§é…ç½®
          { name: 'è·å–å¤§ä½¿ç­‰çº§é…ç½®', function: 'system', action: 'getAmbassadorLevelConfigs', type: 'è¯»æ“ä½œ', test: testGetAmbassadorLevelConfigs },
          { name: 'æ›´æ–°å¤§ä½¿ç­‰çº§é…ç½®', function: 'system', action: 'updateAmbassadorLevelConfig', type: 'å†™æ“ä½œ', test: testUpdateAmbassadorLevelConfig },
          { name: 'åˆå§‹åŒ–å¤§ä½¿ç­‰çº§é…ç½®', function: 'system', action: 'initAmbassadorLevelConfigs', type: 'å†™æ“ä½œ', test: testInitAmbassadorLevelConfigs }
        ]
      },

      user: {
        title: 'ç”¨æˆ·ç®¡ç†æ¨¡å— (4ä¸ªæ¥å£)',
        apis: [
          { name: 'è·å–å­¦å‘˜åˆ—è¡¨', function: 'user', action: 'getUserList', type: 'è¯»æ“ä½œ', test: testGetUserList },
          { name: 'è·å–å­¦å‘˜è¯¦æƒ…', function: 'user', action: 'getUserDetail', type: 'è¯»æ“ä½œ', test: testGetUserDetail },
          { name: 'ä¿®æ”¹å­¦å‘˜æ¨èäºº', function: 'user', action: 'updateUserReferee', type: 'å†™æ“ä½œ', test: testUpdateUserReferee },
          { name: 'è·å–æ¨èäººå˜æ›´æ—¥å¿—', function: 'user', action: 'getRefereeChangeLogs', type: 'è¯»æ“ä½œ', test: testGetRefereeChangeLogs }
        ]
      },

      order: {
        title: 'è®¢å•ç®¡ç†æ¨¡å— (6ä¸ªæ¥å£)',
        apis: [
          { name: 'è·å–è®¢å•åˆ—è¡¨', function: 'order', action: 'getOrderList', type: 'è¯»æ“ä½œ', test: testGetOrderList },
          { name: 'è·å–è®¢å•è¯¦æƒ…', function: 'order', action: 'getOrderDetail', type: 'è¯»æ“ä½œ', test: testGetOrderDetail },
          { name: 'è·å–é€€æ¬¾åˆ—è¡¨', function: 'order', action: 'getRefundList', type: 'è¯»æ“ä½œ', test: testGetRefundList },
          { name: 'ç®¡ç†å‘˜é€€æ¬¾', function: 'order', action: 'refund', type: 'å†™æ“ä½œ', test: testRefund },
          { name: 'è·å–æç°åˆ—è¡¨', function: 'order', action: 'getWithdrawList', type: 'è¯»æ“ä½œ', test: testGetWithdrawList },
          { name: 'å®¡æ ¸æç°ç”³è¯·', function: 'order', action: 'withdrawAudit', type: 'å†™æ“ä½œ', test: testWithdrawAudit }
        ]
      },

      course: {
        title: 'è¯¾ç¨‹ç®¡ç†æ¨¡å— (20ä¸ªæ¥å£)',
        apis: [
          // è¯¾ç¨‹ç®¡ç†
          { name: 'è·å–è¯¾ç¨‹åˆ—è¡¨', function: 'course', action: 'getCourseList', type: 'è¯»æ“ä½œ', test: testGetCourseList },
          { name: 'åˆ›å»ºè¯¾ç¨‹', function: 'course', action: 'createCourse', type: 'å†™æ“ä½œ', test: testCreateCourse },
          { name: 'æ›´æ–°è¯¾ç¨‹', function: 'course', action: 'updateCourse', type: 'å†™æ“ä½œ', test: testUpdateCourse },
          { name: 'åˆ é™¤è¯¾ç¨‹', function: 'course', action: 'deleteCourse', type: 'å†™æ“ä½œ', test: testDeleteCourse },

          // ä¸Šè¯¾æ’æœŸ
          { name: 'è·å–ä¸Šè¯¾æ’æœŸåˆ—è¡¨', function: 'course', action: 'getClassRecordList', type: 'è¯»æ“ä½œ', test: testGetClassRecordList },
          { name: 'åˆ›å»ºä¸Šè¯¾æ’æœŸ', function: 'course', action: 'createClassRecord', type: 'å†™æ“ä½œ', test: testCreateClassRecord },
          { name: 'æ›´æ–°ä¸Šè¯¾æ’æœŸ', function: 'course', action: 'updateClassRecord', type: 'å†™æ“ä½œ', test: testUpdateClassRecord },
          { name: 'åˆ é™¤ä¸Šè¯¾æ’æœŸ', function: 'course', action: 'deleteClassRecord', type: 'å†™æ“ä½œ', test: testDeleteClassRecord },

          // é¢„çº¦ç®¡ç†
          { name: 'è·å–é¢„çº¦åˆ—è¡¨', function: 'course', action: 'getAppointmentList', type: 'è¯»æ“ä½œ', test: testGetAppointmentList },
          { name: 'æ›´æ–°é¢„çº¦çŠ¶æ€', function: 'course', action: 'updateAppointmentStatus', type: 'å†™æ“ä½œ', test: testUpdateAppointmentStatus },
          { name: 'æ‰¹é‡ç­¾åˆ°', function: 'course', action: 'batchCheckin', type: 'å†™æ“ä½œ', test: testBatchCheckin },

          // æ¡ˆä¾‹ç®¡ç†
          { name: 'è·å–æ¡ˆä¾‹åˆ—è¡¨', function: 'course', action: 'getCaseList', type: 'è¯»æ“ä½œ', test: testGetCaseList },
          { name: 'åˆ›å»ºæ¡ˆä¾‹', function: 'course', action: 'createCase', type: 'å†™æ“ä½œ', test: testCreateCase },
          { name: 'æ›´æ–°æ¡ˆä¾‹', function: 'course', action: 'updateCase', type: 'å†™æ“ä½œ', test: testUpdateCase },
          { name: 'åˆ é™¤æ¡ˆä¾‹', function: 'course', action: 'deleteCase', type: 'å†™æ“ä½œ', test: testDeleteCase },

          // èµ„æ–™ç®¡ç†
          { name: 'è·å–èµ„æ–™åˆ—è¡¨', function: 'course', action: 'getMaterialList', type: 'è¯»æ“ä½œ', test: testGetMaterialList },
          { name: 'åˆ›å»ºèµ„æ–™', function: 'course', action: 'createMaterial', type: 'å†™æ“ä½œ', test: testCreateMaterial },
          { name: 'æ›´æ–°èµ„æ–™', function: 'course', action: 'updateMaterial', type: 'å†™æ“ä½œ', test: testUpdateMaterial },
          { name: 'åˆ é™¤èµ„æ–™', function: 'course', action: 'deleteMaterial', type: 'å†™æ“ä½œ', test: testDeleteMaterial },

          // å•†å­¦é™¢
          { name: 'ç®¡ç†å•†å­¦é™¢å†…å®¹', function: 'course', action: 'manageAcademyContent', type: 'å†™æ“ä½œ', test: testManageAcademyContent }
        ]
      },

      ambassador: {
        title: 'å¤§ä½¿ç®¡ç†æ¨¡å— (15ä¸ªæ¥å£)',
        apis: [
          // å¤§ä½¿ç®¡ç†
          { name: 'è·å–å¤§ä½¿åˆ—è¡¨', function: 'ambassador', action: 'getAmbassadorList', type: 'è¯»æ“ä½œ', test: testGetAmbassadorList },
          { name: 'è·å–å¤§ä½¿è¯¦æƒ…', function: 'ambassador', action: 'getAmbassadorDetail', type: 'è¯»æ“ä½œ', test: testGetAmbassadorDetail },

          // ç”³è¯·ç®¡ç†
          { name: 'è·å–å¤§ä½¿ç”³è¯·åˆ—è¡¨', function: 'ambassador', action: 'getApplicationList', type: 'è¯»æ“ä½œ', test: testGetApplicationList },
          { name: 'å®¡æ ¸å¤§ä½¿ç”³è¯·', function: 'ambassador', action: 'auditApplication', type: 'å†™æ“ä½œ', test: testAuditApplication },

          // æ´»åŠ¨ç®¡ç†
          { name: 'è·å–æ´»åŠ¨åˆ—è¡¨', function: 'ambassador', action: 'getActivityList', type: 'è¯»æ“ä½œ', test: testGetActivityList },
          { name: 'åˆ›å»ºæ´»åŠ¨', function: 'ambassador', action: 'createActivity', type: 'å†™æ“ä½œ', test: testCreateActivity },
          { name: 'æ›´æ–°æ´»åŠ¨', function: 'ambassador', action: 'updateActivity', type: 'å†™æ“ä½œ', test: testUpdateActivity },
          { name: 'åˆ é™¤æ´»åŠ¨', function: 'ambassador', action: 'deleteActivity', type: 'å†™æ“ä½œ', test: testDeleteActivity },

          // åè®®æ¨¡æ¿
          { name: 'è·å–åè®®æ¨¡æ¿åˆ—è¡¨', function: 'ambassador', action: 'getContractTemplateList', type: 'è¯»æ“ä½œ', test: testGetContractTemplateList },
          { name: 'åˆ›å»ºåè®®æ¨¡æ¿', function: 'ambassador', action: 'createContractTemplate', type: 'å†™æ“ä½œ', test: testCreateContractTemplate },
          { name: 'æ›´æ–°åè®®æ¨¡æ¿', function: 'ambassador', action: 'updateContractTemplate', type: 'å†™æ“ä½œ', test: testUpdateContractTemplate },
          { name: 'åˆ é™¤åè®®æ¨¡æ¿', function: 'ambassador', action: 'deleteContractTemplate', type: 'å†™æ“ä½œ', test: testDeleteContractTemplate },
          { name: 'è·å–åè®®ç‰ˆæœ¬å†å²', function: 'ambassador', action: 'getContractVersions', type: 'è¯»æ“ä½œ', test: testGetContractVersions },

          // ç­¾ç½²ç®¡ç†
          { name: 'è·å–ç­¾ç½²åˆ—è¡¨', function: 'ambassador', action: 'getSignatureList', type: 'è¯»æ“ä½œ', test: testGetSignatureList },
          { name: 'è·å–å³å°†åˆ°æœŸåè®®', function: 'ambassador', action: 'getExpiringContracts', type: 'è¯»æ“ä½œ', test: testGetExpiringContracts }
        ]
      }
    };

    // åˆå§‹åŒ–æµ‹è¯•ç»“æœ
    function initTestResults() {
      testResults = {
        total: 0,
        success: 0,
        error: 0,
        pending: 0,
        modules: {}
      };

      for (const [moduleName, moduleData] of Object.entries(testAPIs)) {
        testResults.modules[moduleName] = {
          title: moduleData.title,
          apis: moduleData.apis.map(api => ({
            ...api,
            status: 'pending'
          }))
        };
        testResults.total += moduleData.apis.length;
        testResults.pending += moduleData.apis.length;
      }

      updateStats();
      renderResults();
    }
