<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¯¼èˆªæµ‹è¯•é¡µé¢</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    .test-section {
      margin: 20px 0;
      padding: 15px;
      background: #f5f5f5;
      border-radius: 8px;
    }
    .result {
      background: white;
      padding: 10px;
      margin: 10px 0;
      border-left: 3px solid #0052d9;
    }
    .success {
      border-left-color: #00a870;
    }
    .error {
      border-left-color: #e34d59;
    }
    button {
      padding: 8px 16px;
      margin: 5px;
      cursor: pointer;
      background: #0052d9;
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover {
      background: #0042b0;
    }
  </style>
</head>
<body>
  <h1>ğŸ§ª ä¾§è¾¹æ å¯¼èˆªæµ‹è¯•å·¥å…·</h1>
  
  <div class="test-section">
    <h2>å½“å‰é¡µé¢ä¿¡æ¯</h2>
    <div id="current-info"></div>
  </div>
  
  <div class="test-section">
    <h2>è·¯å¾„è®¡ç®—æµ‹è¯•</h2>
    <div id="path-calculation"></div>
  </div>
  
  <div class="test-section">
    <h2>å¯¼èˆªåŠŸèƒ½æµ‹è¯•</h2>
    <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•ä¸åŒé¡µé¢çš„è·³è½¬ï¼š</p>
    <button onclick="testNavigation('dashboard')">æ•°æ®æ¦‚è§ˆ</button>
    <button onclick="testNavigation('user-list')">å­¦å‘˜åˆ—è¡¨</button>
    <button onclick="testNavigation('order-list')">è®¢å•åˆ—è¡¨</button>
    <button onclick="testNavigation('course-list')">è¯¾ç¨‹åˆ—è¡¨</button>
    <button onclick="testNavigation('case-list')">æ¡ˆä¾‹ç®¡ç†</button>
    <button onclick="testNavigation('material-list')">èµ„æ–™ç®¡ç†</button>
    <button onclick="testNavigation('ambassador-list')">å¤§ä½¿åˆ—è¡¨</button>
    <button onclick="testNavigation('admin-list')">ç®¡ç†å‘˜ç®¡ç†</button>
    <div id="navigation-results"></div>
  </div>

  <script src="./assets/libs/vue.global.js"></script>
  <script src="./assets/libs/tdesign.min.js"></script>
  <script src="./assets/js/config.js"></script>
  <script src="./assets/js/admin-api.js"></script>
  <script src="./assets/js/sidebar-navigation.js"></script>
  
  <script>
    // æ˜¾ç¤ºå½“å‰é¡µé¢ä¿¡æ¯
    function showCurrentInfo() {
      const path = window.location.pathname;
      const segments = path.split('/').filter(s => s);
      const adminIndex = segments.findIndex(s => s === 'admin');
      
      const html = `
        <div class="result">
          <p><strong>å®Œæ•´è·¯å¾„ï¼š</strong>${path}</p>
          <p><strong>è·¯å¾„ç‰‡æ®µï¼š</strong>${segments.join(' / ')}</p>
          <p><strong>adminä½ç½®ï¼š</strong>${adminIndex}</p>
          <p><strong>ç‰‡æ®µæ€»æ•°ï¼š</strong>${segments.length}</p>
        </div>
      `;
      
      document.getElementById('current-info').innerHTML = html;
    }
    
    // æµ‹è¯•è·¯å¾„è®¡ç®—
    function testPathCalculation() {
      const testCases = [
        { path: '/admin/index.html', expectedLevel: 0, expectedPrefix: './' },
        { path: '/admin/pages/user/list.html', expectedLevel: 2, expectedPrefix: '../../' },
        { path: '/admin/pages/course/case.html', expectedLevel: 2, expectedPrefix: '../../' },
      ];
      
      let html = '';
      
      testCases.forEach(test => {
        // æ¨¡æ‹Ÿè·¯å¾„
        const segments = test.path.split('/').filter(s => s);
        const adminIndex = segments.findIndex(s => s === 'admin');
        const calculatedLevel = segments.length - adminIndex - 2;
        
        let calculatedPrefix;
        if (calculatedLevel === 0) calculatedPrefix = './';
        else if (calculatedLevel === 1) calculatedPrefix = '../';
        else if (calculatedLevel === 2) calculatedPrefix = '../../';
        else calculatedPrefix = '../../../';
        
        const levelCorrect = calculatedLevel === test.expectedLevel;
        const prefixCorrect = calculatedPrefix === test.expectedPrefix;
        const isSuccess = levelCorrect && prefixCorrect;
        
        html += `
          <div class="result ${isSuccess ? 'success' : 'error'}">
            <p><strong>è·¯å¾„ï¼š</strong>${test.path}</p>
            <p><strong>è®¡ç®—å±‚çº§ï¼š</strong>${calculatedLevel} (æœŸæœ›: ${test.expectedLevel}) ${levelCorrect ? 'âœ…' : 'âŒ'}</p>
            <p><strong>è®¡ç®—å‰ç¼€ï¼š</strong>${calculatedPrefix} (æœŸæœ›: ${test.expectedPrefix}) ${prefixCorrect ? 'âœ…' : 'âŒ'}</p>
          </div>
        `;
      });
      
      document.getElementById('path-calculation').innerHTML = html;
    }
    
    // æµ‹è¯•å¯¼èˆª
    function testNavigation(value) {
      const routes = {
        'dashboard': 'index.html',
        'user-list': 'pages/user/list.html',
        'user-referee': 'pages/user/referee.html',
        'order-list': 'pages/order/list.html',
        'order-refund': 'pages/order/refund.html',
        'withdraw-audit': 'pages/order/withdraw-audit.html',
        'course-list': 'pages/course/list.html',
        'schedule-list': 'pages/course/schedule.html',
        'appointment-list': 'pages/course/appointment.html',
        'case-list': 'pages/course/case.html',
        'material-list': 'pages/course/material.html',
        'ambassador-list': 'pages/ambassador/list.html',
        'application-audit': 'pages/ambassador/application-audit.html',
        'activity-list': 'pages/ambassador/activity.html',
        'contract-list': 'pages/ambassador/contract.html',
        'admin-list': 'pages/system/admin.html',
        'config': 'pages/system/config.html',
        'announcement-list': 'pages/system/announcement.html',
        'feedback-list': 'pages/system/feedback.html',
        'notification-list': 'pages/system/notification.html',
        'level-config': 'pages/system/level-config.html',
      };
      
      const targetPath = routes[value];
      if (!targetPath) {
        alert('æœªæ‰¾åˆ°è·¯ç”±: ' + value);
        return;
      }
      
      // ä½¿ç”¨ sidebar-navigation.js çš„å‡½æ•°è®¡ç®—å‰ç¼€
      const prefix = typeof getPathPrefix === 'function' ? getPathPrefix() : './';
      const fullPath = prefix + targetPath;
      
      const resultHtml = `
        <div class="result success">
          <p><strong>èœå•é¡¹ï¼š</strong>${value}</p>
          <p><strong>ç›®æ ‡è·¯å¾„ï¼š</strong>${targetPath}</p>
          <p><strong>è·¯å¾„å‰ç¼€ï¼š</strong>${prefix}</p>
          <p><strong>å®Œæ•´è·¯å¾„ï¼š</strong>${fullPath}</p>
          <p><strong>çŠ¶æ€ï¼š</strong>å‡†å¤‡è·³è½¬...</p>
        </div>
      `;
      
      document.getElementById('navigation-results').innerHTML = resultHtml;
      
      // å»¶è¿Ÿè·³è½¬ï¼Œè®©ç”¨æˆ·çœ‹åˆ°ç»“æœ
      setTimeout(() => {
        window.location.href = fullPath;
      }, 1000);
    }
    
    // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œæµ‹è¯•
    window.onload = function() {
      showCurrentInfo();
      testPathCalculation();
    };
  </script>
</body>
</html>




