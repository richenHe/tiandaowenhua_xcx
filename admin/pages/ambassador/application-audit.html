<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>ç”³è¯·å®¡æ ¸</title><link rel="stylesheet" href="../../assets/libs/tdesign.min.css"><link rel="stylesheet" href="../../assets/css/tokens.css"><style>body{margin:0;padding:20px;background:#f5f5f5}.page-container{max-width:1400px;margin:0 auto;background:white;border-radius:8px;padding:24px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}.page-title{font-size:20px;font-weight:600;margin-bottom:8px}.page-desc{font-size:14px;color:#999;margin-bottom:24px}.search-bar{display:flex;gap:12px;margin-bottom:20px;flex-wrap:wrap}
    /* TDesign å¸ƒå±€æ ·å¼ - å¿…éœ€ï¼*/
    .t-layout {
      height: 100vh;
    }
    
    .t-layout__header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 24px;
      background: #fff;
      border-bottom: 1px solid #dcdcdc;
    }
    
    .t-layout__sider {
      background: #fff;
      border-right: 1px solid #dcdcdc;
      width: 240px !important;
      flex-shrink: 0;
    }
    
    .t-layout__content {
      padding: 24px;
      overflow-y: auto;
      background: #f5f5f5;
    }

  </style></head><body>
  <div id="app">
    <t-layout style="height: 100vh;">
      <!-- é¡¶éƒ¨å¯¼èˆª -->
      <t-header height="64px" style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 24px;
        background: #fff;
        border-bottom: 1px solid #dcdcdc;
      ">
        <div style="display: flex; align-items: center; gap: 16px;">
          <span style="font-size: 18px; font-weight: 600; color: #333;">ğŸ¨ å¤©é“æ–‡åŒ–åå°ç®¡ç†</span>
        </div>
        <div style="display: flex; align-items: center; gap: 16px;">
          <span>{{ adminInfo?.real_name || adminInfo?.username || 'ç®¡ç†å‘˜' }}</span>
          <t-button size="small" @click="handleLogout">é€€å‡º</t-button>
        </div>
      </t-header>
      
      <t-layout>
        <!-- ä¾§è¾¹èœå• -->
        <t-aside width="240px" style="
          background: #fff;
          border-right: 1px solid #dcdcdc;
          overflow-y: auto;
        ">
          <t-menu
            value="application-audit"
            :default-expanded="['user', 'order', 'course', 'ambassador', 'system']"
            theme="light"
            @change="handleMenuChange"
          >
            <t-menu-item value="dashboard">
              <template #icon><t-icon name="dashboard" /></template>
              æ•°æ®æ¦‚è§ˆ
            </t-menu-item>
            
            <t-submenu value="user">
              <template #icon><t-icon name="user" /></template>
              <template #title>ç”¨æˆ·ç®¡ç†</template>
              <t-menu-item value="user-list">å­¦å‘˜åˆ—è¡¨</t-menu-item>
              <t-menu-item value="user-referee">æ¨èå…³ç³»æŸ¥è¯¢</t-menu-item>
              <t-menu-item value="user-referee-logs">æ¨èäººå˜æ›´è®°å½•</t-menu-item>
            </t-submenu>
            
            <t-submenu value="order">
              <template #icon><t-icon name="order" /></template>
              <template #title>è®¢å•ç®¡ç†</template>
              <t-menu-item value="order-list">è®¢å•åˆ—è¡¨</t-menu-item>
              <t-menu-item value="order-refund">é€€æ¬¾ç®¡ç†</t-menu-item>
              <t-menu-item value="withdraw-audit">æç°å®¡æ ¸</t-menu-item>
            </t-submenu>
            
            <t-submenu value="course">
              <template #icon><t-icon name="file" /></template>
              <template #title>è¯¾ç¨‹ç®¡ç†</template>
              <t-menu-item value="course-list">è¯¾ç¨‹åˆ—è¡¨</t-menu-item>
              <t-menu-item value="schedule-list">æ’æœŸç®¡ç†</t-menu-item>
              <t-menu-item value="appointment-list">é¢„çº¦ç®¡ç†</t-menu-item>
              <t-menu-item value="case-list">æ¡ˆä¾‹ç®¡ç†</t-menu-item>
              <t-menu-item value="material-list">èµ„æ–™ç®¡ç†</t-menu-item>
            </t-submenu>
            
            <t-submenu value="ambassador">
              <template #icon><t-icon name="usergroup" /></template>
              <template #title>å¤§ä½¿ç®¡ç†</template>
              <t-menu-item value="ambassador-list">å¤§ä½¿åˆ—è¡¨</t-menu-item>
              <t-menu-item value="application-audit">ç”³è¯·å®¡æ ¸</t-menu-item>
              <t-menu-item value="activity-list">æ´»åŠ¨ç®¡ç†</t-menu-item>
              <t-menu-item value="contract-list">åˆçº¦ç®¡ç†</t-menu-item>
            </t-submenu>
            
            <t-submenu value="system">
              <template #icon><t-icon name="setting" /></template>
              <template #title>ç³»ç»Ÿç®¡ç†</template>
              <t-menu-item value="admin-list">ç®¡ç†å‘˜ç®¡ç†</t-menu-item>
              <t-menu-item value="config">ç³»ç»Ÿé…ç½®</t-menu-item>
              <t-menu-item value="announcement-list">å…¬å‘Šç®¡ç†</t-menu-item>
              <t-menu-item value="feedback-list">åé¦ˆç®¡ç†</t-menu-item>
              <t-menu-item value="notification-list">é€šçŸ¥ç®¡ç†</t-menu-item>
              <t-menu-item value="level-config">ç­‰çº§é…ç½®</t-menu-item>
            </t-submenu>
          </t-menu>
        </t-aside>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <t-content class="page-content"><div class="page-container"><h1 class="page-title">ç”³è¯·å®¡æ ¸</h1><p class="page-desc">å®¡æ ¸å¤§ä½¿å‡çº§ç”³è¯·</p><div class="search-bar"><t-input v-model="filters.keyword" placeholder="å§“å/æ‰‹æœºå·" clearable style="width:200px;"/><t-select v-model="filters.targetLevel" :options="levelOptions" placeholder="ç›®æ ‡ç­‰çº§" clearable style="width:150px;"/><t-select v-model="filters.status" :options="statusOptions" placeholder="çŠ¶æ€" clearable style="width:150px;"/><t-button theme="primary" @click="handleSearch">æŸ¥è¯¢</t-button><t-button theme="default" @click="handleReset">é‡ç½®</t-button></div><t-table :data="tableData" :columns="columns" :loading="loading" :pagination="pagination" @page-change="handlePageChange" row-key="id" bordered stripe><template #targetLevel="{row}"><t-tag v-if="row.target_level===1">äº‘é›€</t-tag><t-tag v-else-if="row.target_level===2" theme="primary">é’é¸¾</t-tag><t-tag v-else theme="warning">é¸¿é¹„</t-tag></template><template #status="{row}"><t-tag v-if="row.status===0" theme="warning">å¾…å®¡æ ¸</t-tag><t-tag v-else-if="row.status===1" theme="success">å·²é€šè¿‡</t-tag><t-tag v-else theme="danger">å·²é©³å›</t-tag></template><template #operation="{row}"><t-space v-if="row.status===0"><t-button theme="success" size="small" variant="text" @click="handleApprove(row)">é€šè¿‡</t-button><t-button theme="danger" size="small" variant="text" @click="handleReject(row)">é©³å›</t-button></t-space><t-button v-else theme="primary" size="small" variant="text" @click="handleView(row)">æŸ¥çœ‹è¯¦æƒ…</t-button></template></t-table></div><t-dialog v-model:visible="rejectVisible" header="é©³å›ç”³è¯·" @confirm="confirmReject"><t-textarea v-model="rejectReason" placeholder="è¯·è¾“å…¥é©³å›åŸå› " :maxlength="200" :autosize="{minRows:4}"/></t-dialog>        </t-content>
      </t-layout>
    </t-layout>
  </div>

  <script src="../../assets/libs/vue.global.js"></script><script src="../../assets/libs/tdesign.min.js"></script><script src="../../assets/js/config.js"></script><script src="../../assets/js/admin-api.js"></script>
  <script src="../../assets/js/sidebar-navigation.js"></script><script>const{createApp,ref,onMounted}=Vue;createApp({
      setup() {
        // å¼•å…¥ä¾§è¾¹æ å¯¼èˆªåŠŸèƒ½
        const { adminInfo, handleMenuChange, handleLogout } = SidebarNavigation.useSidebarNavigation();
        const loading=ref(false);const tableData=ref([]);const rejectVisible=ref(false);const rejectReason=ref('');const rejectTarget=ref(null);const filters=ref({keyword:'',targetLevel:null,status:null});const levelOptions=[{label:'äº‘é›€',value:1},{label:'é’é¸¾',value:2},{label:'é¸¿é¹„',value:3}];const statusOptions=[{label:'å¾…å®¡æ ¸',value:0},{label:'å·²é€šè¿‡',value:1},{label:'å·²é©³å›',value:2}];const pagination=ref({current:1,pageSize:20,total:0});const columns=[{colKey:'user_name',title:'ç”³è¯·äºº',width:120},{colKey:'phone',title:'æ‰‹æœºå·',width:130},{colKey:'current_level',title:'å½“å‰ç­‰çº§',width:100},{colKey:'targetLevel',title:'ç›®æ ‡ç­‰çº§',width:100,cell:'targetLevel'},{colKey:'reason',title:'ç”³è¯·ç†ç”±',ellipsis:true},{colKey:'created_at',title:'ç”³è¯·æ—¶é—´',width:160},{colKey:'status',title:'çŠ¶æ€',width:100,cell:'status'},{colKey:'operation',title:'æ“ä½œ',width:150,fixed:'right',cell:'operation'}];const fetchData=async()=>{loading.value=true;try{const data=await AdminAPI.getAmbassadorApplicationList({page:pagination.value.current,pageSize:pagination.value.pageSize,...filters.value});tableData.value=data.list;pagination.value.total=data.total;}catch(error){TDesign.MessagePlugin.error(error.message||'è·å–å¤±è´¥');}finally{loading.value=false;}};const handleSearch=()=>{pagination.value.current=1;fetchData();};const handleReset=()=>{filters.value={keyword:'',targetLevel:null,status:null};handleSearch();};const handlePageChange=(pi)=>{pagination.value.current=pi.current;pagination.value.pageSize=pi.pageSize;fetchData();};const handleApprove=async(row)=>{const confirmed=await TDesign.DialogPlugin.confirm({header:'ç¡®è®¤é€šè¿‡',body:`ç¡®è®¤é€šè¿‡ ${row.user_name} çš„å‡çº§ç”³è¯·å—ï¼Ÿ`});if(!confirmed)return;try{await AdminAPI.approveAmbassadorApplication({applicationId:row.id});TDesign.MessagePlugin.success('å·²é€šè¿‡');fetchData();}catch(error){TDesign.MessagePlugin.error(error.message||'æ“ä½œå¤±è´¥');}};const handleReject=(row)=>{rejectTarget.value=row.id;rejectVisible.value=true;};const confirmReject=async()=>{if(!rejectReason.value.trim()){TDesign.MessagePlugin.warning('è¯·è¾“å…¥é©³å›åŸå› ');return;}try{await AdminAPI.rejectAmbassadorApplication({applicationId:rejectTarget.value,rejectReason:rejectReason.value});TDesign.MessagePlugin.success('å·²é©³å›');rejectVisible.value=false;rejectReason.value='';fetchData();}catch(error){TDesign.MessagePlugin.error(error.message||'æ“ä½œå¤±è´¥');}};const handleView=(row)=>{TDesign.MessagePlugin.info('æŸ¥çœ‹è¯¦æƒ…åŠŸèƒ½');};onMounted(fetchData);return {
          // ä¾§è¾¹æ å¯¼èˆª
          adminInfo,
          handleMenuChange,
          handleLogout,
          loading,tableData,rejectVisible,rejectReason,filters,levelOptions,statusOptions,pagination,columns,handleSearch,handleReset,handlePageChange,handleApprove,handleReject,confirmReject,handleView
        };}}).use(TDesign).mount('#app');</script></body></html>








