<!DOCTYPE html><html><head><meta charset="UTF-8"><title>ç®¡ç†å‘˜ç®¡ç†</title><link rel="stylesheet" href="../../assets/libs/tdesign.min.css"><style>body{margin:0;padding:20px;background:#f5f5f5}.c{max-width:1400px;margin:0 auto;background:white;border-radius:8px;padding:24px}.t{font-size:20px;font-weight:600;margin-bottom:24px}.b{display:flex;gap:12px;margin-bottom:20px}
    /* TDesign å¸ƒå±€æ ·å¼ - å¿…éœ€ï¼*/
    .t-layout {
      height: 100vh;
    }
    
    .t-layout__header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 24px;
      background: #fff;
      border-bottom: 1px solid #dcdcdc;
    }
    
    .t-layout__sider {
      background: #fff;
      border-right: 1px solid #dcdcdc;
      width: 240px !important;
      flex-shrink: 0;
    }
    
    .t-layout__content {
      padding: 24px;
      overflow-y: auto;
      background: #f5f5f5;
    }

  </style></head><body>
  <div id="app">
    <t-layout style="height: 100vh;">
      <!-- é¡¶éƒ¨å¯¼èˆª -->
      <t-header height="64px" style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 24px;
        background: #fff;
        border-bottom: 1px solid #dcdcdc;
      ">
        <div style="display: flex; align-items: center; gap: 16px;">
          <span style="font-size: 18px; font-weight: 600; color: #333;">ğŸ¨ å¤©é“æ–‡åŒ–åå°ç®¡ç†</span>
        </div>
        <div style="display: flex; align-items: center; gap: 16px;">
          <span>{{ adminInfo?.real_name || adminInfo?.username || 'ç®¡ç†å‘˜' }}</span>
          <t-button size="small" @click="handleLogout">é€€å‡º</t-button>
        </div>
      </t-header>
      
      <t-layout>
        <!-- ä¾§è¾¹èœå• -->
        <t-aside width="240px" style="
          background: #fff;
          border-right: 1px solid #dcdcdc;
          overflow-y: auto;
        ">
          <t-menu
            value="admin-list"
            :default-expanded="['user', 'order', 'course', 'ambassador', 'system']"
            theme="light"
            @change="handleMenuChange"
          >
            <t-menu-item value="dashboard">
              <template #icon><t-icon name="dashboard" /></template>
              æ•°æ®æ¦‚è§ˆ
            </t-menu-item>
            
            <t-submenu value="user">
              <template #icon><t-icon name="user" /></template>
              <template #title>ç”¨æˆ·ç®¡ç†</template>
              <t-menu-item value="user-list">å­¦å‘˜åˆ—è¡¨</t-menu-item>
              <t-menu-item value="user-referee">æ¨èäººç®¡ç†</t-menu-item>
            </t-submenu>
            
            <t-submenu value="order">
              <template #icon><t-icon name="order" /></template>
              <template #title>è®¢å•ç®¡ç†</template>
              <t-menu-item value="order-list">è®¢å•åˆ—è¡¨</t-menu-item>
              <t-menu-item value="order-refund">é€€æ¬¾ç®¡ç†</t-menu-item>
              <t-menu-item value="withdraw-audit">æç°å®¡æ ¸</t-menu-item>
            </t-submenu>
            
            <t-submenu value="course">
              <template #icon><t-icon name="file" /></template>
              <template #title>è¯¾ç¨‹ç®¡ç†</template>
              <t-menu-item value="course-list">è¯¾ç¨‹åˆ—è¡¨</t-menu-item>
              <t-menu-item value="schedule-list">æ’æœŸç®¡ç†</t-menu-item>
              <t-menu-item value="appointment-list">é¢„çº¦ç®¡ç†</t-menu-item>
              <t-menu-item value="case-list">æ¡ˆä¾‹ç®¡ç†</t-menu-item>
              <t-menu-item value="material-list">èµ„æ–™ç®¡ç†</t-menu-item>
            </t-submenu>
            
            <t-submenu value="ambassador">
              <template #icon><t-icon name="usergroup" /></template>
              <template #title>å¤§ä½¿ç®¡ç†</template>
              <t-menu-item value="ambassador-list">å¤§ä½¿åˆ—è¡¨</t-menu-item>
              <t-menu-item value="application-audit">ç”³è¯·å®¡æ ¸</t-menu-item>
              <t-menu-item value="activity-list">æ´»åŠ¨ç®¡ç†</t-menu-item>
              <t-menu-item value="contract-list">åˆçº¦ç®¡ç†</t-menu-item>
            </t-submenu>
            
            <t-submenu value="system">
              <template #icon><t-icon name="setting" /></template>
              <template #title>ç³»ç»Ÿç®¡ç†</template>
              <t-menu-item value="admin-list">ç®¡ç†å‘˜ç®¡ç†</t-menu-item>
              <t-menu-item value="config">ç³»ç»Ÿé…ç½®</t-menu-item>
              <t-menu-item value="announcement-list">å…¬å‘Šç®¡ç†</t-menu-item>
              <t-menu-item value="feedback-list">åé¦ˆç®¡ç†</t-menu-item>
              <t-menu-item value="notification-list">é€šçŸ¥ç®¡ç†</t-menu-item>
              <t-menu-item value="level-config">ç­‰çº§é…ç½®</t-menu-item>
            </t-submenu>
          </t-menu>
        </t-aside>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <t-content class="page-content"><div class="c"><h1 class="t">ç®¡ç†å‘˜ç®¡ç†</h1><div class="b"><t-input v-model="k" placeholder="ç”¨æˆ·å/å§“å" clearable style="width:200px;"/><t-button theme="primary" @click="ld">æŸ¥è¯¢</t-button><t-button @click="rs">é‡ç½®</t-button><t-button theme="success" @click="add">æ·»åŠ ç®¡ç†å‘˜</t-button></div><t-table :data="d" :columns="cols" :loading="lg" :pagination="pg" @page-change="chg" bordered stripe><template #role="{row}"><t-tag v-if="row.role==='super'" theme="danger">è¶…çº§ç®¡ç†å‘˜</t-tag><t-tag v-else theme="primary">æ™®é€šç®¡ç†å‘˜</t-tag></template><template #status="{row}"><t-tag v-if="row.status===1" theme="success">æ­£å¸¸</t-tag><t-tag v-else theme="danger">ç¦ç”¨</t-tag></template><template #op="{row}"><t-space><t-button size="small" variant="text" @click="edit(row)">ç¼–è¾‘</t-button><t-button size="small" variant="text" theme="warning" @click="toggle(row)">{{row.status===1?'ç¦ç”¨':'å¯ç”¨'}}</t-button><t-button v-if="row.role!=='super'" size="small" variant="text" theme="danger" @click="del(row)">åˆ é™¤</t-button></t-space></template></t-table></div><t-dialog v-model:visible="v" :header="m==='add'?'æ·»åŠ ç®¡ç†å‘˜':'ç¼–è¾‘ç®¡ç†å‘˜'" @confirm="save"><t-form :data="f" :rules="rules" label-width="100px"><t-form-item label="ç”¨æˆ·å" name="username"><t-input v-model="f.username" :disabled="m==='edit'"/></t-form-item><t-form-item label="å§“å" name="real_name"><t-input v-model="f.real_name"/></t-form-item><t-form-item v-if="m==='add'" label="å¯†ç " name="password"><t-input v-model="f.password" type="password"/></t-form-item><t-form-item label="è§’è‰²" name="role"><t-select v-model="f.role" :options="roleOpts"/></t-form-item></t-form></t-dialog>        </t-content>
      </t-layout>
    </t-layout>
  </div>

  <script src="../../assets/libs/vue.global.js"></script><script src="../../assets/libs/tdesign.min.js"></script><script src="../../assets/js/config.js"></script><script src="../../assets/js/admin-api.js"></script>
  <script src="../../assets/js/sidebar-navigation.js"></script><script>const{createApp,ref,onMounted}=Vue;createApp({
      setup() {
        // å¼•å…¥ä¾§è¾¹æ å¯¼èˆªåŠŸèƒ½
        const { adminInfo, handleMenuChange, handleLogout } = SidebarNavigation.useSidebarNavigation();
        const lg=ref(false);const d=ref([]);const v=ref(false);const m=ref('add');const f=ref({});const k=ref('');const pg=ref({current:1,pageSize:20,total:0});const roleOpts=[{label:'è¶…çº§ç®¡ç†å‘˜',value:'super'},{label:'æ™®é€šç®¡ç†å‘˜',value:'normal'}];const cols=[{colKey:'username',title:'ç”¨æˆ·å',width:150},{colKey:'real_name',title:'å§“å',width:120},{colKey:'role',title:'è§’è‰²',width:150,cell:'role'},{colKey:'last_login_at',title:'æœ€åç™»å½•',width:160},{colKey:'status',title:'çŠ¶æ€',width:100,cell:'status'},{colKey:'op',title:'æ“ä½œ',width:200,cell:'op'}];const rules={username:[{required:true,message:'è¯·è¾“å…¥ç”¨æˆ·å'}],real_name:[{required:true,message:'è¯·è¾“å…¥å§“å'}],password:[{required:true,message:'è¯·è¾“å…¥å¯†ç '}],role:[{required:true,message:'è¯·é€‰æ‹©è§’è‰²'}]};const ld=async()=>{lg.value=true;try{const data=await AdminAPI.getAdminList({page:pg.value.current,pageSize:pg.value.pageSize,keyword:k.value});d.value=data.list;pg.value.total=data.total;}catch(e){TDesign.MessagePlugin.error(e.message);}finally{lg.value=false;}};const rs=()=>{k.value='';ld();};const chg=pi=>{pg.value.current=pi.current;pg.value.pageSize=pi.pageSize;ld();};const add=()=>{m.value='add';f.value={role:'normal'};v.value=true;};const edit=row=>{m.value='edit';f.value={...row};v.value=true;};const toggle=async row=>{try{await AdminAPI.toggleAdminStatus({adminId:row.id});TDesign.MessagePlugin.success('æ“ä½œæˆåŠŸ');ld();}catch(e){TDesign.MessagePlugin.error(e.message);}};const del=async row=>{const ok=await TDesign.DialogPlugin.confirm({header:'ç¡®è®¤åˆ é™¤',body:`ç¡®è®¤åˆ é™¤ç®¡ç†å‘˜ ${row.real_name} å—ï¼Ÿ`});if(!ok)return;try{await AdminAPI.deleteAdmin({adminId:row.id});TDesign.MessagePlugin.success('åˆ é™¤æˆåŠŸ');ld();}catch(e){TDesign.MessagePlugin.error(e.message);}};const save=async()=>{try{if(m.value==='add')await AdminAPI.createAdmin(f.value);else await AdminAPI.updateAdmin(f.value);TDesign.MessagePlugin.success('ä¿å­˜æˆåŠŸ');v.value=false;ld();}catch(e){TDesign.MessagePlugin.error(e.message);}};onMounted(ld);return {
          // ä¾§è¾¹æ å¯¼èˆª
          adminInfo,
          handleMenuChange,
          handleLogout,
          lg,d,v,m,f,k,pg,roleOpts,cols,rules,ld,rs,chg,add,edit,toggle,del,save
        };}}).use(TDesign).mount('#app');</script></body></html>





