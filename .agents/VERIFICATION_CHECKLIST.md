# æ•°æ®åº“å­—æ®µå¯¹é½ä¿®å¤ - éªŒè¯æ¸…å•

## ğŸ“‹ ä¿®å¤å®Œæˆæƒ…å†µ

âœ… **å·²å®Œæˆæ‰€æœ‰ä»£ç ä¿®å¤**ï¼Œå…±ä¿®æ”¹ **15 ä¸ªæ–‡ä»¶**

---

## ğŸ” éªŒè¯æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²äº‘å‡½æ•°

```bash
# è¿›å…¥äº‘å‡½æ•°ç›®å½•
cd cloudfunctions

# éƒ¨ç½² course äº‘å‡½æ•°
tcb fn deploy course

# éƒ¨ç½² order äº‘å‡½æ•°
tcb fn deploy order
```

---

### ç¬¬äºŒæ­¥ï¼šéªŒè¯åå°ç®¡ç†ç³»ç»Ÿ

#### 1. è¯¾ç¨‹åˆ—è¡¨é¡µé¢ (`admin/pages/course/list.html`)

**æ£€æŸ¥é¡¹ç›®**ï¼š
- [ ] æ‰“å¼€é¡µé¢ï¼Œè¯¾ç¨‹åˆ—è¡¨æ˜¯å¦æ˜¾ç¤ºæ•°æ®
- [ ] è¯¾ç¨‹å›¾ç‰‡æ˜¯å¦æ­£å¸¸æ˜¾ç¤º
- [ ] æ£€æŸ¥ä»¥ä¸‹å­—æ®µæ˜¯å¦å®Œæ•´æ˜¾ç¤ºï¼š
  - [ ] ID
  - [ ] è¯¾ç¨‹å›¾ç‰‡ï¼ˆcover_imageï¼‰
  - [ ] è¯¾ç¨‹åç§°ï¼ˆnameï¼‰
  - [ ] è¯¾ç¨‹æ˜µç§°ï¼ˆnicknameï¼‰
  - [ ] è¯¾ç¨‹ç±»å‹ï¼ˆtypeï¼‰
  - [ ] ç°ä»·ï¼ˆcurrent_priceï¼‰
  - [ ] åŸä»·ï¼ˆoriginal_priceï¼‰
  - [ ] è¯¾ç¨‹æ—¶é•¿ï¼ˆdurationï¼‰
  - [ ] å·²å”®ï¼ˆsold_countï¼‰
  - [ ] æ’åºï¼ˆsort_orderï¼‰
  - [ ] çŠ¶æ€ï¼ˆstatusï¼‰
  - [ ] åˆ›å»ºæ—¶é—´ï¼ˆcreated_atï¼‰
- [ ] ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®ï¼Œå­—æ®µæ˜¯å¦æ­£ç¡®å›å¡«
- [ ] ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯åä¿å­˜ï¼Œæ•°æ®æ˜¯å¦æ­£ç¡®æ›´æ–°

**é¢„æœŸç»“æœ**ï¼š
- æ‰€æœ‰å­—æ®µå®Œæ•´æ˜¾ç¤ºï¼Œæ— ç¼ºå¤±
- å›¾ç‰‡æ­£å¸¸åŠ è½½
- ç¼–è¾‘åŠŸèƒ½æ­£å¸¸

---

#### 2. æ’æœŸç®¡ç†é¡µé¢ (`admin/pages/course/schedule.html`)

**æ£€æŸ¥é¡¹ç›®**ï¼š
- [ ] æ‰“å¼€é¡µé¢ï¼Œæ’æœŸåˆ—è¡¨æ˜¯å¦æ˜¾ç¤ºæ•°æ®
- [ ] æ£€æŸ¥ä»¥ä¸‹å­—æ®µæ˜¯å¦æ­£ç¡®æ˜¾ç¤ºï¼š
  - [ ] è¯¾ç¨‹åç§°ï¼ˆcourse_nameï¼‰
  - [ ] ä¸Šè¯¾æ—¥æœŸï¼ˆclass_dateï¼‰
  - [ ] ä¸Šè¯¾æ—¶é—´ï¼ˆclass_timeï¼‰
  - [ ] ä¸Šè¯¾åœ°ç‚¹ï¼ˆclass_locationï¼‰
  - [ ] å·²é¢„çº¦ï¼ˆbooked_quotaï¼‰
  - [ ] æ€»åé¢ï¼ˆtotal_quotaï¼‰
  - [ ] çŠ¶æ€ï¼ˆstatusï¼‰
- [ ] åé¢æ˜¾ç¤ºæ˜¯å¦æ­£ç¡®ï¼ˆä¾‹å¦‚ï¼š5/30 è¡¨ç¤ºå·²é¢„çº¦5äººï¼Œæ€»åé¢30äººï¼‰
- [ ] åˆ›å»ºæ–°æ’æœŸæ—¶ï¼Œå­—æ®µæ˜¯å¦æ­£ç¡®

**é¢„æœŸç»“æœ**ï¼š
- åé¢å­—æ®µä½¿ç”¨ `booked_quota` å’Œ `total_quota`
- æ—¶é—´å­—æ®µåˆå¹¶ä¸º `class_time`
- åœ°ç‚¹å­—æ®µä½¿ç”¨ `class_location`

---

#### 3. è®¢å•åˆ—è¡¨é¡µé¢ (`admin/pages/order/list.html`)

**æ£€æŸ¥é¡¹ç›®**ï¼š
- [ ] æ‰“å¼€é¡µé¢ï¼Œè®¢å•åˆ—è¡¨æ˜¯å¦æ˜¾ç¤ºæ•°æ®
- [ ] æ£€æŸ¥ä»¥ä¸‹å­—æ®µæ˜¯å¦æ­£ç¡®æ˜¾ç¤ºï¼š
  - [ ] è®¢å•ç¼–å·ï¼ˆorder_noï¼‰
  - [ ] ç”¨æˆ·æ˜µç§°ï¼ˆuser_nicknameï¼‰
  - [ ] è®¢å•ç±»å‹ï¼ˆorder_type_textï¼‰
  - [ ] å•†å“åç§°ï¼ˆorder_nameï¼‰
  - [ ] åŸä»·ï¼ˆoriginal_amountï¼‰
  - [ ] ä¼˜æƒ ï¼ˆdiscount_amountï¼‰
  - [ ] å®ä»˜ï¼ˆfinal_amountï¼‰
  - [ ] è®¢å•çŠ¶æ€ï¼ˆpay_status_textï¼‰
  - [ ] æ”¯ä»˜æ–¹å¼ï¼ˆpay_methodï¼‰
  - [ ] åˆ›å»ºæ—¶é—´ï¼ˆcreated_atï¼‰
- [ ] é‡‘é¢è®¡ç®—æ˜¯å¦æ­£ç¡®ï¼ˆåŸä»· - ä¼˜æƒ  = å®ä»˜ï¼‰

**é¢„æœŸç»“æœ**ï¼š
- æ‰€æœ‰é‡‘é¢å­—æ®µå®Œæ•´æ˜¾ç¤º
- ç”¨æˆ·æ˜µç§°æ­£ç¡®æ˜¾ç¤º
- è®¢å•çŠ¶æ€æ–‡æœ¬æ­£ç¡®

---

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯å°ç¨‹åº

#### 1. è¯¾ç¨‹æ’æœŸé¡µé¢

**æ£€æŸ¥é¡¹ç›®**ï¼š
- [ ] æ‰“å¼€è¯¾ç¨‹æ’æœŸé¡µé¢
- [ ] åé¢æ˜¾ç¤ºæ˜¯å¦æ­£ç¡®ï¼ˆå‰©ä½™åé¢/æ€»åé¢ï¼‰
- [ ] é¢„çº¦åŠŸèƒ½æ˜¯å¦æ­£å¸¸

**é¢„æœŸç»“æœ**ï¼š
- åé¢å­—æ®µä½¿ç”¨ `total_quota` å’Œ `booked_quota`
- å¯ç”¨åé¢è®¡ç®—æ­£ç¡®

---

#### 2. è®¢å•è¯¦æƒ…é¡µé¢

**æ£€æŸ¥é¡¹ç›®**ï¼š
- [ ] æ‰“å¼€è®¢å•è¯¦æƒ…é¡µé¢
- [ ] æ£€æŸ¥ä»¥ä¸‹å­—æ®µæ˜¯å¦æ˜¾ç¤ºï¼š
  - [ ] åŸä»·ï¼ˆoriginal_amountï¼‰
  - [ ] ä¼˜æƒ ï¼ˆdiscount_amountï¼‰
  - [ ] å®ä»˜ï¼ˆfinal_amountï¼‰
  - [ ] ç”¨æˆ·å§“åï¼ˆuser_nameï¼‰
  - [ ] ç”¨æˆ·ç”µè¯ï¼ˆuser_phoneï¼‰
- [ ] é‡‘é¢è®¡ç®—æ˜¯å¦æ­£ç¡®

**é¢„æœŸç»“æœ**ï¼š
- æ‰€æœ‰å­—æ®µå®Œæ•´æ˜¾ç¤º
- é‡‘é¢è®¡ç®—æ­£ç¡®

---

### ç¬¬å››æ­¥ï¼šæŸ¥çœ‹äº‘å‡½æ•°æ—¥å¿—

**æ£€æŸ¥é¡¹ç›®**ï¼š
- [ ] æ‰“å¼€è…¾è®¯äº‘æ§åˆ¶å°
- [ ] æŸ¥çœ‹ `course` äº‘å‡½æ•°æ—¥å¿—
- [ ] æŸ¥çœ‹ `order` äº‘å‡½æ•°æ—¥å¿—
- [ ] æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—
- [ ] æ£€æŸ¥ `getCourseList` çš„è°ƒè¯•æ—¥å¿—è¾“å‡º

**é¢„æœŸç»“æœ**ï¼š
- æ— é”™è¯¯æ—¥å¿—
- è°ƒè¯•æ—¥å¿—æ­£å¸¸è¾“å‡ºæŸ¥è¯¢å‚æ•°å’Œç»“æœ

---

## ğŸ“Š ä¿®å¤æ–‡ä»¶æ¸…å•

### åå°é¡µé¢ï¼ˆ3ä¸ªï¼‰
1. âœ… `admin/pages/course/list.html`
2. âœ… `admin/pages/course/schedule.html`
3. âœ… `admin/pages/order/list.html`

### äº‘å‡½æ•°ï¼ˆ8ä¸ªï¼‰
1. âœ… `cloudfunctions/course/handlers/admin/getCourseList.js`
2. âœ… `cloudfunctions/course/handlers/admin/updateClassRecord.js`
3. âœ… `cloudfunctions/course/handlers/client/createAppointment.js`
4. âœ… `cloudfunctions/course/handlers/client/cancelAppointment.js`
5. âœ… `cloudfunctions/course/handlers/client/getClassRecords.js`
6. âœ… `cloudfunctions/order/handlers/client/getDetail.js`
7. âœ… `cloudfunctions/order/handlers/admin/getOrderDetail.js`
8. âœ… `cloudfunctions/order/handlers/admin/getOrderList.js`

### ç±»å‹å®šä¹‰ï¼ˆ2ä¸ªï¼‰
1. âœ… `universal-cloudbase-uniapp-template/src/api/types/course.ts`
2. âœ… `universal-cloudbase-uniapp-template/src/api/types/order.ts`

### å°ç¨‹åºé¡µé¢ï¼ˆ1ä¸ªï¼‰
1. âœ… `universal-cloudbase-uniapp-template/src/pages/course/schedule/index.vue`

### é…ç½®æ–‡ä»¶ï¼ˆ1ä¸ªï¼‰
1. âœ… `cloudfunctions/cloudbaserc.json`

---

## ğŸ”‘ å…³é”®å­—æ®µå¯¹ç…§è¡¨

### è¯¾ç¨‹æ¨¡å—

| æ—§å­—æ®µ | æ–°å­—æ®µ | è¯´æ˜ |
|--------|--------|------|
| `image` | `cover_image` | å°é¢å›¾ç‰‡ |
| `price` | `current_price` | ç°ä»· |
| - | `original_price` | åŸä»·ï¼ˆæ–°å¢ï¼‰ |
| - | `nickname` | è¯¾ç¨‹æ˜µç§°ï¼ˆæ–°å¢ï¼‰ |
| - | `sold_count` | å·²å”®æ•°é‡ï¼ˆæ–°å¢ï¼‰ |

### æ’æœŸæ¨¡å—

| æ—§å­—æ®µ | æ–°å­—æ®µ | è¯´æ˜ |
|--------|--------|------|
| `max_students` | `total_quota` | æ€»åé¢ |
| `current_students` | `booked_quota` | å·²é¢„çº¦åé¢ |
| `start_time` + `end_time` | `class_time` | ä¸Šè¯¾æ—¶é—´ï¼ˆåˆå¹¶ï¼‰ |
| `location` | `class_location` | ä¸Šè¯¾åœ°ç‚¹ |

### è®¢å•æ¨¡å—

| æ—§å­—æ®µ | æ–°å­—æ®µ | è¯´æ˜ |
|--------|--------|------|
| `total_amount` | `original_amount` | åŸä»· |
| - | `discount_amount` | ä¼˜æƒ é‡‘é¢ï¼ˆæ–°å¢ï¼‰ |
| `paid_amount` | `final_amount` | å®ä»˜é‡‘é¢ |
| - | `user_name` | ç”¨æˆ·å§“åï¼ˆæ–°å¢ï¼‰ |
| - | `user_phone` | ç”¨æˆ·ç”µè¯ï¼ˆæ–°å¢ï¼‰ |
| - | `user_nickname` | ç”¨æˆ·æ˜µç§°ï¼ˆæ–°å¢ï¼‰ |

---

## âš ï¸ å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šåå°è¯¾ç¨‹åˆ—è¡¨æ— æ•°æ®

**å¯èƒ½åŸå› **ï¼š
- äº‘å‡½æ•°æœªéƒ¨ç½²
- æ•°æ®åº“è¿æ¥å¤±è´¥
- æŸ¥è¯¢æ¡ä»¶é”™è¯¯

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥äº‘å‡½æ•°æ˜¯å¦éƒ¨ç½²æˆåŠŸ
2. æŸ¥çœ‹äº‘å‡½æ•°æ—¥å¿—ï¼Œç¡®è®¤æ˜¯å¦æœ‰é”™è¯¯
3. æ£€æŸ¥ `getCourseList` çš„è°ƒè¯•æ—¥å¿—è¾“å‡º

---

### é—®é¢˜2ï¼šå­—æ®µæ˜¾ç¤ºä¸ºç©º

**å¯èƒ½åŸå› **ï¼š
- å­—æ®µåç§°ä¸åŒ¹é…
- æ•°æ®åº“å­—æ®µä¸å­˜åœ¨
- äº‘å‡½æ•°è¿”å›å­—æ®µç¼ºå¤±

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥æ•°æ®åº“è¡¨ç»“æ„ï¼Œç¡®è®¤å­—æ®µå­˜åœ¨
2. æ£€æŸ¥äº‘å‡½æ•°è¿”å›æ•°æ®ï¼Œç¡®è®¤å­—æ®µåç§°æ­£ç¡®
3. æ£€æŸ¥å‰ç«¯ä»£ç ï¼Œç¡®è®¤å­—æ®µæ˜ å°„æ­£ç¡®

---

### é—®é¢˜3ï¼šåé¢æ˜¾ç¤ºé”™è¯¯

**å¯èƒ½åŸå› **ï¼š
- ä½¿ç”¨äº†æ—§å­—æ®µåç§°
- å­—æ®µç±»å‹ä¸åŒ¹é…

**æ’æŸ¥æ­¥éª¤**ï¼š
1. ç¡®è®¤ä½¿ç”¨ `total_quota` å’Œ `booked_quota`
2. æ£€æŸ¥æ•°æ®åº“å­—æ®µç±»å‹æ˜¯å¦ä¸ºæ•´æ•°
3. æ£€æŸ¥äº‘å‡½æ•°è¿”å›æ•°æ®æ ¼å¼

---

## ğŸ“ éªŒè¯å®Œæˆå

éªŒè¯å®Œæˆåï¼Œè¯·è®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼š

- [ ] æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸
- [ ] æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—
- [ ] æ˜¯å¦éœ€è¦è¿›ä¸€æ­¥ä¿®å¤

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. å…·ä½“çš„é”™è¯¯ä¿¡æ¯
2. äº‘å‡½æ•°æ—¥å¿—æˆªå›¾
3. æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

---

**éªŒè¯æ¸…å•åˆ›å»ºæ—¶é—´**ï¼š2026-02-13
**ä¿®å¤çŠ¶æ€**ï¼šâœ… ä»£ç ä¿®å¤å®Œæˆï¼Œç­‰å¾…éªŒè¯
